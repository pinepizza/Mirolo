<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TimeSetu</title>
    <link rel="stylesheet" href="popup.css">
    <link rel="stylesheet" href="voiceReview.css">
    <link rel="stylesheet" href="focus-block.css">
    <script src="lib/chart.min.js"></script>
</head>
<body>
    <div class="container">
        <header class="main-header">
            <h1>TimeSetu</h1>
            <div class="flag-container">
                <div id="selectedFlag" class="selected-flag">
                    <img id="currentFlag" src="flags/us.png" alt="English" class="flag-icon">
                </div>
                <div id="flagDropdown" class="flag-dropdown">
                    <div class="flag-option" data-flag="us"><img src="flags/us.png" alt="English"><span>English</span></div>
                    <div class="flag-option" data-flag="cn"><img src="flags/cn.png" alt="‰∏≠Êñá"><span>‰∏≠Êñá</span></div>
                    <div class="flag-option" data-flag="in"><img src="flags/in.png" alt="‡§π‡§ø‡§®‡•ç‡§¶‡•Ä"><span>‡§π‡§ø‡§®‡•ç‡§¶‡•Ä</span></div>
                    <div class="flag-option" data-flag="jp"><img src="flags/jp.png" alt="Êó•Êú¨Ë™û"><span>Êó•Êú¨Ë™û</span></div>
                    <div class="flag-option" data-flag="fr"><img src="flags/fr.png" alt="Fran√ßais"><span>Fran√ßais</span></div>
                    <div class="flag-option" data-flag="es"><img src="flags/es.png" alt="Espa√±ol"><span>Espa√±ol</span></div>
                </div>
            </div>
            <div class="time-period">
                <button id="todayBtn" class="time-btn active">Today</button>
                <button id="weekBtn" class="time-btn">This Week</button>
            </div>
        </header>

        <section class="main-content">
            <div class="total-time-card">
                <h2>Total Time Today</h2>
                <p id="totalTime">--:--:--</p>
            </div>

            <div class="view-switcher">
                <button id="categoryViewBtn" class="view-btn active">By Category</button>
                <button id="websiteViewBtn" class="switcher-btn">By Website</button>
            </div>

            <div class="chart-container">
                <canvas id="categoryChart"></canvas>
            </div>
        </section>

        <section class="top-sites">
            <h2>Top Sites</h2>
            <div id="topSitesList" class="sites-list"></div>
        </section>

        <section class="actions">
            <button id="goalsBtn" class="action-btn">üéØ Goals</button>
            <button id="settingsBtn" class="action-btn">‚öôÔ∏è Settings</button>
            <button id="moreBtn" class="action-btn">üìä More</button>
        </section>

        <!-- Focus Mode Block List Section (Collapsible) -->
        <details class="focus-block-section" id="focusBlockDropdown">
            <summary>
                <span>Focus Mode Block List</span>
                <!-- Toggle Switch -->
                <label class="focus-switch">
                    <input type="checkbox" id="focusModeToggle">
                    <span class="slider"></span>
                </label>
            </summary>

            <p>Automatically block these sites during Focus Mode:</p>
            <div id="focusBlockedSitesList" class="blocked-sites-list"></div>
            <div class="block-input">
                <input type="text" id="focusSiteToBlock" placeholder="e.g., facebook.com">
                <button id="addFocusBlockBtn">‚ûï</button>
            </div>
            <div class="focus-timer">
                <input type="number" id="focusDuration" placeholder="Minutes (optional)">
                <button id="startFocusBtn">Start Focus</button>
            </div>
            <p id="focusCountdown" class="note"></p>
            <p class="note">These sites will only be blocked when Focus Mode is active.</p>
        </details>

        <!-- Category Block List Section (Collapsible) -->
        <details class="focus-block-section" id="youtubeCategoryBlockDropdown" style="margin-top: 16px;">
            <summary>
                <span>üö´ Block Categories</span>
            </summary>

            <p style="margin-bottom: 16px; color: var(--text-secondary);">Block specific YouTube video categories. Videos from blocked categories will be hidden from your feed and search results.</p>
            
            <div class="category-block-list" style="margin-bottom: 16px;">
                <div class="category-block-item" style="display: flex; align-items: center; justify-content: space-between; padding: 12px; background: rgba(255, 255, 255, 0.03); border-radius: 8px; margin-bottom: 8px; border: 1px solid rgba(255, 255, 255, 0.1);">
                    <div style="display: flex; align-items: center; gap: 12px;">
                        <span style="font-size: 1.2rem;">üìö</span>
                        <div>
                            <div style="font-weight: 600; color: var(--text-primary);">Productive / Educational</div>
                            <div style="font-size: 0.85rem; color: var(--text-secondary);">Tutorials, courses, learning content</div>
                        </div>
                    </div>
                    <label class="focus-switch" style="margin: 0;">
                        <input type="checkbox" id="blockCategoryProductive" class="category-block-checkbox" data-category="Productive">
                        <span class="slider"></span>
                    </label>
                </div>

                <div class="category-block-item" style="display: flex; align-items: center; justify-content: space-between; padding: 12px; background: rgba(255, 255, 255, 0.03); border-radius: 8px; margin-bottom: 8px; border: 1px solid rgba(255, 255, 255, 0.1);">
                    <div style="display: flex; align-items: center; gap: 12px;">
                        <span style="font-size: 1.2rem;">üé¨</span>
                        <div>
                            <div style="font-weight: 600; color: var(--text-primary);">Entertainment</div>
                            <div style="font-size: 0.85rem; color: var(--text-secondary);">Music, comedy, fun videos</div>
                        </div>
                    </div>
                    <label class="focus-switch" style="margin: 0;">
                        <input type="checkbox" id="blockCategoryEntertainment" class="category-block-checkbox" data-category="Entertainment">
                        <span class="slider"></span>
                    </label>
                </div>

                <div class="category-block-item" style="display: flex; align-items: center; justify-content: space-between; padding: 12px; background: rgba(255, 255, 255, 0.03); border-radius: 8px; margin-bottom: 8px; border: 1px solid rgba(255, 255, 255, 0.1);">
                    <div style="display: flex; align-items: center; gap: 12px;">
                        <span style="font-size: 1.2rem;">üì∞</span>
                        <div>
                            <div style="font-weight: 600; color: var(--text-primary);">News</div>
                            <div style="font-size: 0.85rem; color: var(--text-secondary);">News reports, current events</div>
                        </div>
                    </div>
                    <label class="focus-switch" style="margin: 0;">
                        <input type="checkbox" id="blockCategoryNews" class="category-block-checkbox" data-category="News">
                        <span class="slider"></span>
                    </label>
                </div>

                <div class="category-block-item" style="display: flex; align-items: center; justify-content: space-between; padding: 12px; background: rgba(255, 255, 255, 0.03); border-radius: 8px; margin-bottom: 8px; border: 1px solid rgba(255, 255, 255, 0.1);">
                    <div style="display: flex; align-items: center; gap: 12px;">
                        <span style="font-size: 1.2rem;">üéÆ</span>
                        <div>
                            <div style="font-weight: 600; color: var(--text-primary);">Games</div>
                            <div style="font-size: 0.85rem; color: var(--text-secondary);">Gaming videos, gameplay</div>
                        </div>
                    </div>
                    <label class="focus-switch" style="margin: 0;">
                        <input type="checkbox" id="blockCategoryGames" class="category-block-checkbox" data-category="Games">
                        <span class="slider"></span>
                    </label>
                </div>
            </div>

            <div id="blockedCategoriesList" class="blocked-sites-list" style="margin-bottom: 16px;"></div>
            
            <p class="note" style="margin-top: 16px; font-size: 0.85rem;">
                üí° Blocked categories will be hidden from YouTube immediately. Changes apply to all YouTube tabs.
            </p>
        </details>

        <footer class="main-footer">
            <button id="dashboardBtn" class="footer-btn">Full Dashboard</button>
        </footer>
    </div>

    <!-- Modals (restored with full content) -->
    <div id="moreModal" class="modal">
        <div class="modal-content">
            <span class="close-btn" id="closeMoreBtn">&times;</span>
            <h2>Weekly Summary</h2>
            <div class="chart-container" style="height: 250px; margin: 20px 0;">
                <canvas id="weeklyChart"></canvas>
            </div>
            <div class="chart-container" style="height: 250px; margin: 30px 0 20px 0;">
                <canvas id="weeklyWebsiteChart"></canvas>
            </div>
            <div id="voiceReviewCard" class="voice-review-card">
                <h3 style="text-align:center;">üîä Weekly AI Review</h3>
                <p id="voiceSummaryText">This week, you spent 14 hours on your devices. 5 hours were productive, 4 hours on entertainment, and 5 hours on social media. Great work on hitting your daily goals 4 out of 7 days!</p>
                <button id="replayVoiceBtn" class="action-btn" style="width:100%;margin-top:8px;">Replay üîÅ</button>
            </div>
            <button id="exportDataBtn" class="action-btn">Export Data</button>
            <!-- Other content for 'More' modal -->
        </div>
    </div>
    <div id="goalsModal" class="modal">
        <div class="modal-content">
            <span class="close-btn" id="closeGoalsBtn">&times;</span>
            <h2>Your Goals</h2>
            <div class="streak-info"></div>
            <div class="goals-container"></div>
            <button id="editGoalsBtn" class="action-btn">Edit Goals</button>
        </div>
    </div>
    <div id="settingsModal" class="modal">
        <div class="modal-content">
            <span class="close-btn" id="closeSettingsBtn">&times;</span>
            <h2>Settings</h2>
            <h3>Manage Categories</h3>
            <div id="categoriesList"></div>
            
            <div class="settings-section" style="margin-top: 32px; padding-top: 24px; border-top: 1px solid rgba(255, 255, 255, 0.1);">
                <h3 style="margin-bottom: 16px; color: var(--text-primary);">üö´ Block Categories</h3>
                <p style="color: var(--text-secondary); margin-bottom: 16px; font-size: 0.9rem;">
                    Block specific YouTube video categories to prevent them from appearing in your feed. Videos will be hidden automatically.
                </p>
                <div class="youtube-category-blocks" style="display: flex; flex-direction: column; gap: 12px;">
                    <div class="setting-item" style="padding: 16px; background: rgba(255, 255, 255, 0.03); border-radius: 12px; border: 1px solid rgba(255, 255, 255, 0.1);">
                        <label class="setting-label" style="display: flex; align-items: center; justify-content: space-between; cursor: pointer;">
                            <div style="display: flex; align-items: center; gap: 12px;">
                                <span style="font-size: 1.2rem;">üì∞</span>
                                <div>
                                    <div style="font-weight: 600; color: var(--text-primary);">Block News Videos</div>
                                    <div style="font-size: 0.85rem; color: var(--text-secondary);">Hide all news-related YouTube videos</div>
                                </div>
                            </div>
                            <input type="checkbox" id="blockYouTubeNews" style="width: 20px; height: 20px; cursor: pointer;">
                        </label>
                    </div>
                    <div class="setting-item" style="padding: 16px; background: rgba(255, 255, 255, 0.03); border-radius: 12px; border: 1px solid rgba(255, 255, 255, 0.1);">
                        <label class="setting-label" style="display: flex; align-items: center; justify-content: space-between; cursor: pointer;">
                            <div style="display: flex; align-items: center; gap: 12px;">
                                <span style="font-size: 1.2rem;">üé¨</span>
                                <div>
                                    <div style="font-weight: 600; color: var(--text-primary);">Block Entertainment Videos</div>
                                    <div style="font-size: 0.85rem; color: var(--text-secondary);">Hide all entertainment YouTube videos</div>
                                </div>
                            </div>
                            <input type="checkbox" id="blockYouTubeEntertainment" style="width: 20px; height: 20px; cursor: pointer;">
                        </label>
                    </div>
                    <div class="setting-item" style="padding: 16px; background: rgba(255, 255, 255, 0.03); border-radius: 12px; border: 1px solid rgba(255, 255, 255, 0.1);">
                        <label class="setting-label" style="display: flex; align-items: center; justify-content: space-between; cursor: pointer;">
                            <div style="display: flex; align-items: center; gap: 12px;">
                                <span style="font-size: 1.2rem;">üìö</span>
                                <div>
                                    <div style="font-weight: 600; color: var(--text-primary);">Block Productive Videos</div>
                                    <div style="font-size: 0.85rem; color: var(--text-secondary);">Hide all educational/productive YouTube videos</div>
                                </div>
                            </div>
                            <input type="checkbox" id="blockYouTubeProductive" style="width: 20px; height: 20px; cursor: pointer;">
                        </label>
                    </div>
                </div>
                <p style="color: var(--text-secondary); margin-top: 16px; font-size: 0.85rem; font-style: italic;">
                    üí° Tip: Blocked categories will be hidden from YouTube search results, recommendations, and your feed.
                </p>
            </div>
            
            <div style="display: flex; gap: 12px; margin-top: 24px;">
                <button id="saveSettingsBtn" class="action-btn" style="flex: 1;">Save Settings</button>
                <button id="saveBrowserSettingsBtn" class="action-btn" style="flex: 1; background: var(--accent-color);">Save All Settings</button>
            </div>
        </div>
    </div>
    <div id="editGoalsModal" class="modal">
        <div class="modal-content">
            <span class="close-btn" id="closeEditGoalsBtn">&times;</span>
            <h2>Edit Goals</h2>
            
            <!-- Goals Type Toggle -->
            <div class="goals-toggle">
                <button id="categoryGoalsBtn" class="toggle-btn active">By Category</button>
                <button id="websiteGoalsBtn" class="toggle-btn">By Website</button>
            </div>
            
            <!-- Category Goals Section -->
            <div id="categoryGoalsSection" class="goals-section">
                <h3>Category Goals</h3>
                <form id="categoryGoals"></form>
            </div>
            
            <!-- Website Goals Section -->
            <div id="websiteGoalsSection" class="goals-section" style="display: none;">
                <h3>Website Goals</h3>
                <div class="website-goals-container">
                    <div id="websiteGoalsList"></div>
                    <div class="add-website-goal">
                        <input type="text" id="newWebsiteGoal" placeholder="Enter website name (e.g., youtube.com)" maxlength="50">
                        <input type="number" id="newWebsiteHours" placeholder="Hours" min="0" max="24" step="0.5">
                        <button id="addWebsiteGoalBtn" type="button">Add</button>
                    </div>
                </div>
            </div>
            
            <button id="saveGoalsBtn" class="action-btn">Save Goals</button>
        </div>
    </div>

    <script src="popup.js"></script>
    <script src="voiceReview.js"></script>
    <script src="focus-block.js"></script>
</body>
</html>